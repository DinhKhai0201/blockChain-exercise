{"ast":null,"code":"'use strict';\n\nconst sort = require('stable');\n\nconst _require = require('../util.js'),\n      serialize = _require.serialize;\n\nconst dagNodeUtil = require('./util.js');\n\nconst linkSort = dagNodeUtil.linkSort;\n\nconst DAGNode = require('./index.js');\n\nconst DAGLink = require('../dag-link');\n\nfunction create(data, links, callback) {\n  if (typeof data === 'function') {\n    callback = data;\n    data = undefined;\n  } else if (typeof data === 'string') {\n    data = Buffer.from(data);\n  }\n\n  if (typeof links === 'function') {\n    callback = links;\n    links = [];\n  }\n\n  if (!Buffer.isBuffer(data)) {\n    return callback(new Error('Passed \\'data\\' is not a buffer or a string!'));\n  }\n\n  links = links.map(link => {\n    return DAGLink.isDAGLink(link) ? link : DAGLink.util.createDagLinkFromB58EncodedHash(link);\n  });\n  links = sort(links, linkSort);\n  serialize({\n    data,\n    links\n  }, (err, buffer) => {\n    if (err) {\n      return callback(err);\n    }\n\n    return callback(null, new DAGNode(data, links, buffer.length));\n  });\n}\n\nmodule.exports = create;","map":null,"metadata":{},"sourceType":"script"}